function botReply(uText) {
    const t = uText.toLowerCase();
    const n = currentChat.toLowerCase();
    let r = "";
    
    // Проверки на ключевые слова
    const isToxic = ["хуй", "пидор", "сука", "блять", "еблан", "чмо"].some(w => t.includes(w));
    const isHi = ["привет", "ку", "хай", "здорово", "здравствуй"].some(w => t.includes(w));
    const isHowAreYou = ["как дела", "как ты", "че делаешь", "как жизнь"].some(w => t.includes(w));

    // Наборы случайных ответов для персонажей
    const replies = {
        "ярослав": {
            hi: ["Здорово. Опять отвлекаешь?", "Чё надо?", "Привет, если не шутишь."],
            how: ["Нормально. Сижу, жду когда ты поумнеешь.", "Пойдёт. А ты чё?", "Всё ок."],
            toxic: ["Слышь, ты че такой борзый?", "За слова ответишь?", "Адрес говори, вычислятор включен."],
            default: ["Ясно. Забей, я занят.", "Мда, интересная (нет) история.", "Понял-принял.", "Ага, рассказывай."]
        },
        "богдан": {
            hi: ["Привет! Я как раз код рефакторю.", "О, привет. Есть вопрос по Python?", "Ку."],
            how: ["Весь в дебаггинге. Тут такая утечка памяти...", "Норм, пишу скрипт для парсинга.", "В процессе."],
            default: ["Python — это мощь. А ты на чём пишешь?", "Интересно... А как это реализовать на JS?", "Мопс — лучший кодер, чем ты.", "Ясно. Пойду документацию почитаю."]
        },
        "тимофей": {
            hi: ["ГО В РОБЛОКС!", "Привет! Зайдешь ко мне в плейс?", "Ооо, привет!"],
            how: ["Круто! Я там новую модельку добавил.", "Норм, строю карту.", "Всё топ!"],
            default: ["ГО В РОБЛОКС СТУДИЮ! Я там карту обновил.", "Смотри какой скрипт на Луа написал!", "Ахаха, жиза.", "Погнали играть?"]
        },
        "generic": ["Ясно...", "Мда...", "Жиза.", "База.", "Понятно.", "Ок.", "Ну ок.", "Бывает же такое.", "И что дальше?"]
    };

    // Логика выбора персонажа
    const char = replies[n] || { default: replies.generic };

    // Выбор категории ответа
    if (isToxic) {
        r = char.toxic ? char.toxic[Math.floor(Math.random() * char.toxic.length)] : replies.generic[Math.floor(Math.random() * replies.generic.length)];
    } else if (isHi) {
        r = char.hi ? char.hi[Math.floor(Math.random() * char.hi.length)] : "Привет.";
    } else if (isHowAreYou) {
        r = char.how ? char.how[Math.floor(Math.random() * char.how.length)] : "Нормально всё.";
    } else if (t.includes("фембой") && n === "ярослав") {
        r = "Фембои это база, чел. Уважаю.";
    } else if (t.includes("мопс") && n === "богдан") {
        r = "Мопс — реально легенда кодинга.";
    } else {
        // Случайная фраза из личного "дефолта" персонажа
        const def = char.default || replies.generic;
        r = def[Math.floor(Math.random() * def.length)];
    }
    
    renderMessage(r, 'msg-incoming');
    histories[currentChat].push({text: r, type: 'msg-incoming'});
    saveHistories();
}
